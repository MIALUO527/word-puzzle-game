<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Puzzle Bloom</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-gradient: linear-gradient(135deg, #e1bfff 0%, #b39ddb 100%);
      --accent: #b39ddb;
      --accent-dark: #7c43bd;
      --correct: #e1bfff;
      --wrong: #ffcdd2;
      --hint: #fff9c4;
      --shadow: 0 4px 16px rgba(120, 80, 180, 0.08);
      --cat1: linear-gradient(135deg, #e1bfff 60%, #b39ddb 100%);
      --cat2: linear-gradient(135deg, #f8bbd0 60%, #e1bee7 100%);
      --cat3: linear-gradient(135deg, #b2ebf2 60%, #b39ddb 100%);
      --cat4: linear-gradient(135deg, #ffe082 60%, #e1bfff 100%);
      --cat5: linear-gradient(135deg, #c8e6c9 60%, #b39ddb 100%);
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--main-gradient);
      min-height: 100vh;
      font-family: 'Quicksand', 'Segoe UI', Arial, sans-serif;
      color: #3a2950;
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .page {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      box-sizing: border-box;
      background: transparent;
    }
    #homePage {
      padding: 32px 8px 24px 8px;
      min-height: 100vh;
      justify-content: flex-start;
    }
    #title {
      font-family: 'Baloo 2', cursive;
      font-size: 2.2rem;
      letter-spacing: 2px;
      background: linear-gradient(90deg, #b39ddb 60%, #e1bfff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.2em;
      margin-top: 0.5em;
    }
    #subtitle {
      font-size: 1.1rem;
      color: #7c43bd;
      font-family: 'Quicksand', sans-serif;
      margin-bottom: 2em;
      letter-spacing: 1px;
    }
    .category-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 22px 16px;
      width: 100%;
      max-width: 370px;
      margin: 0 auto;
      margin-bottom: 2em;
    }
    .category-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 14px 0 8px 0;
      cursor: pointer;
      transition: box-shadow 0.18s, transform 0.18s;
      border: none;
      outline: none;
      min-width: 0;
      min-height: 0;
      user-select: none;
      position: relative;
      color: #6a1b9a;
      font-weight: 600;
      background: var(--cat1);
      /* 默认色，后面用JS动态分配 */
    }
    .category-btn img {
      width: 44px;
      height: 44px;
      margin-bottom: 6px;
      object-fit: contain;
      display: block;
      filter: drop-shadow(0 2px 8px #b39ddb33);
    }
    .category-label {
      font-size: 1rem;
      font-family: 'Quicksand', sans-serif;
      color: #6a1b9a;
      font-weight: 700;
      letter-spacing: 0.5px;
      margin-top: 0;
      margin-bottom: 0;
      text-align: center;
      word-break: break-all;
      text-shadow: 0 2px 8px #fff6;
    }
    .category-btn:hover, .category-btn:active {
      box-shadow: 0 6px 24px rgba(120, 80, 180, 0.16);
      transform: translateY(-2px) scale(1.04);
      filter: brightness(1.08);
    }
    /* 游戏页 */
    #gamePage {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      min-height: 100vh;
      padding: 24px 8px 16px 8px;
      box-sizing: border-box;
      background: transparent;
    }
    .game-header {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    #levelText, #streakText {
      font-size: 1.1rem;
      color: #7c43bd;
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
    }
    #clueText {
      width: 100%;
      background: linear-gradient(90deg, #fff9c4 60%, #e1bfff 100%);
      color: #7c43bd;
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 1.1rem;
      margin: 12px 0 18px 0;
      box-shadow: 0 2px 8px #e1bfff33;
      text-align: center;
      font-family: 'Quicksand', sans-serif;
      letter-spacing: 0.5px;
      min-height: 1.5em;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #grid {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 18px;
      min-height: 54px;
      margin-top: 8px;
      transition: box-shadow 0.2s;
    }
    .cell {
      width: 44px;
      height: 44px;
      background: #fff;
      border: 2px solid #b39ddb;
      border-radius: 12px;
      font-size: 1.5rem;
      font-family: 'Baloo 2', cursive;
      font-weight: bold;
      color: #7c43bd;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px #e1bfff22;
      cursor: pointer;
      transition: background 0.2s, border 0.2s;
      user-select: none;
    }
    .cell.correct {
      background: #e1bfff;
      animation: cell-bloom 0.8s;
    }
    @keyframes cell-bloom {
      0% { box-shadow: 0 0 0 0 #e1bfff; }
      100% { box-shadow: 0 0 16px 8px #e1bfff44; }
    }
    #grid.shake {
      animation: shake 0.6s;
    }
    @keyframes shake {
      10%, 90% { transform: translateX(-2px); }
      20%, 80% { transform: translateX(4px); }
      30%, 50%, 70% { transform: translateX(-8px); }
      40%, 60% { transform: translateX(8px); }
      100% { transform: none; }
    }
    #letterBox {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 18px;
      min-height: 54px;
    }
    .letter {
      width: 44px;
      height: 44px;
      background: #fff9c4;
      border: 2px solid #fbc02d;
      border-radius: 14px;
      font-size: 1.2rem;
      font-family: 'Baloo 2', cursive;
      color: #7c43bd;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 2px 8px #e1bfff22;
      transition: background 0.18s, border 0.18s;
    }
    .letter:active {
      background: #ffe082;
      border-color: #fbc02d;
    }
    .game-controls {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 10px;
      margin-bottom: 10px;
      width: 100%;
    }
    .game-controls button {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 18px;
      font-size: 1rem;
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 8px #e1bfff33;
      transition: background 0.18s, transform 0.18s;
    }
    .game-controls button:active {
      background: var(--accent-dark);
      transform: scale(0.97);
    }
    #nextBtn { display: none; }
    /* 花瓣动画 */
    .petal {
      position: fixed;
      top: -40px;
      width: 24px;
      height: 24px;
      background: radial-gradient(circle at 60% 40%, #e1bfff 70%, #b39ddb 100%);
      border-radius: 50% 50% 50% 50%/60% 60% 40% 40%;
      opacity: 0.8;
      pointer-events: none;
      z-index: 9999;
      animation: petal-fall linear forwards;
    }
    @keyframes petal-fall {
      to {
        top: 100vh;
        transform: translateY(0) rotate(360deg) scale(0.7);
        opacity: 0.2;
      }
    }
    /* Toast */
    #toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(80,0,120,0.9);
      color: #fff;
      padding: 10px 24px;
      border-radius: 24px;
      font-size: 18px;
      z-index: 9999;
      transition: opacity 0.3s;
      opacity: 0;
      pointer-events: none;
    }
    @media (max-width: 600px) {
      .page, #gamePage, #homePage {
        max-width: 100vw;
        padding-left: 0;
        padding-right: 0;
      }
      .category-grid {
        max-width: 98vw;
        gap: 18px 8px;
      }
      .category-btn {
        padding: 10px 0 6px 0;
      }
      #clueText {
        font-size: 1rem;
        padding: 8px 6px;
      }
      .cell, .letter {
        width: 38px;
        height: 38px;
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
  <div id="homePage" class="page">
    <div id="title">Puzzle Bloom</div>
    <div id="subtitle">Let your brain blossom with words.</div>
    <div class="category-grid" id="categoryGrid">
      <div class="category-btn" data-bg="1" onclick="startGame('food')">
        <img src="https://img.icons8.com/color/48/meal.png" alt="Food"/>
        <div class="category-label">Food</div>
      </div>
      <div class="category-btn" data-bg="2" onclick="startGame('fashion')">
        <img src="https://img.icons8.com/color/48/dress-front-view.png" alt="Fashion"/>
        <div class="category-label">Fashion</div>
      </div>
      <div class="category-btn" data-bg="3" onclick="startGame('animals')">
        <img src="https://img.icons8.com/color/48/cat.png" alt="Animals"/>
        <div class="category-label">Animals</div>
      </div>
      <div class="category-btn" data-bg="4" onclick="startGame('city')">
        <img src="https://img.icons8.com/color/48/city.png" alt="City"/>
        <div class="category-label">City</div>
      </div>
      <div class="category-btn" data-bg="5" onclick="startGame('color')">
        <img src="https://img.icons8.com/color/48/paint-palette.png" alt="Color"/>
        <div class="category-label">Color</div>
      </div>
      <div class="category-btn" data-bg="1" onclick="startGame('sport')">
        <img src="https://img.icons8.com/color/48/soccer-ball.png" alt="Sport"/>
        <div class="category-label">Sport</div>
      </div>
      <div class="category-btn" data-bg="2" onclick="startGame('fruit')">
        <img src="https://img.icons8.com/color/48/banana.png" alt="Fruit"/>
        <div class="category-label">Fruit</div>
      </div>
      <div class="category-btn" data-bg="3" onclick="startGame('job')">
        <img src="https://img.icons8.com/color/48/worker-male.png" alt="Job"/>
        <div class="category-label">Job</div>
      </div>
      <div class="category-btn" data-bg="4" onclick="startGame('plant')">
        <img src="https://img.icons8.com/color/48/flower.png" alt="Plant"/>
        <div class="category-label">Plant</div>
      </div>
      <div class="category-btn" data-bg="5" onclick="startGame('music')">
        <img src="https://img.icons8.com/color/48/musical-notes.png" alt="Music"/>
        <div class="category-label">Music</div>
      </div>
    </div>
  </div>
  <div id="gamePage" class="page" style="display:none;">
    <div class="game-header">
      <span id="levelText"></span>
      <span id="streakText"></span>
    </div>
    <div id="clueText"></div>
    <div id="grid"></div>
    <div id="letterBox"></div>
    <div class="game-controls">
      <button id="backBtn" type="button">Back</button>
      <button id="nextBtn" type="button">Next</button>
      <button id="homeBtn" type="button">Home</button>
    </div>
  </div>
  <div id="toast"></div>
    <script>
    // 题库，每个分类10题
    const allWordData = {
      food: [
        { answer: "APPLE", clue: "A fruit and a tech company" },
        { answer: "BREAD", clue: "Staple food, often sliced" },
        { answer: "PIZZA", clue: "Italian dish with cheese" },
        { answer: "JUICE", clue: "Drink made from fruits" },
        { answer: "HONEY", clue: "Sweet, made by bees" },
        { answer: "SUSHI", clue: "Japanese rice and fish" },
        { answer: "GRAPE", clue: "Small, purple or green fruit" },
        { answer: "CHEESE", clue: "Dairy, often on pizza" },
        { answer: "BURGER", clue: "Fast food, with a patty" },
        { answer: "SALAD", clue: "Mixed vegetables, often raw" }
      ],
      fashion: [
        { answer: "DRESS", clue: "One-piece garment for women" },
        { answer: "SHIRT", clue: "Buttoned top, often with collar" },
        { answer: "SKIRT", clue: "Lower garment, not pants" },
        { answer: "JEANS", clue: "Denim pants" },
        { answer: "SCARF", clue: "Worn around the neck" },
        { answer: "JACKET", clue: "Outerwear, keeps you warm" },
        { answer: "HAT", clue: "Worn on the head" },
        { answer: "SHOES", clue: "Worn on feet" },
        { answer: "BELT", clue: "Keeps pants up" },
        { answer: "COAT", clue: "Long outer garment" }
      ],
      animals: [
        { answer: "TIGER", clue: "Big cat with stripes" },
        { answer: "HORSE", clue: "Ridden by cowboys" },
        { answer: "SHEEP", clue: "Gives us wool" },
        { answer: "EAGLE", clue: "Majestic bird of prey" },
        { answer: "FROG", clue: "Jumps and croaks" },
        { answer: "MOUSE", clue: "Small rodent, likes cheese" },
        { answer: "SNAKE", clue: "Legless reptile" },
        { answer: "PANDA", clue: "Black and white bear" },
        { answer: "WHALE", clue: "Largest mammal" },
        { answer: "ZEBRA", clue: "Striped African animal" }
      ],
      city: [
        { answer: "PARIS", clue: "City of lights" },
        { answer: "TOKYO", clue: "Capital of Japan" },
        { answer: "LONDON", clue: "Big Ben is here" },
        { answer: "SYDNEY", clue: "Opera House city" },
        { answer: "DUBAI", clue: "Burj Khalifa city" },
        { answer: "BERLIN", clue: "Capital of Germany" },
        { answer: "MADRID", clue: "Capital of Spain" },
        { answer: "ROME", clue: "Colosseum city" },
        { answer: "SEOUL", clue: "Capital of South Korea" },
        { answer: "CAIRO", clue: "Pyramids city" }
      ],
      color: [
        { answer: "PURPLE", clue: "Mix of red and blue" },
        { answer: "ORANGE", clue: "Fruit and color" },
        { answer: "YELLOW", clue: "Color of the sun" },
        { answer: "GREEN", clue: "Color of grass" },
        { answer: "BLACK", clue: "Opposite of white" },
        { answer: "WHITE", clue: "Opposite of black" },
        { answer: "BROWN", clue: "Color of chocolate" },
        { answer: "PINK", clue: "Light red" },
        { answer: "BLUE", clue: "Color of the sky" },
        { answer: "RED", clue: "Color of blood" }
      ],
      sport: [
        { answer: "SOCCER", clue: "Football in Europe" },
        { answer: "TENNIS", clue: "Played with rackets" },
        { answer: "BOXING", clue: "Fighting with gloves" },
        { answer: "GOLF", clue: "Clubs and holes" },
        { answer: "SKIING", clue: "Snow and slopes" },
        { answer: "CYCLING", clue: "Riding a bicycle" },
        { answer: "SWIM", clue: "In the pool or sea" },
        { answer: "RUGBY", clue: "Oval ball, tough sport" },
        { answer: "CRICKET", clue: "Bat and ball, England" },
        { answer: "HOCKEY", clue: "Stick and puck/ball" }
      ],
      fruit: [
        { answer: "BANANA", clue: "Yellow, monkeys love it" },
        { answer: "MANGO", clue: "King of fruits" },
        { answer: "PEACH", clue: "Fuzzy skin, sweet" },
        { answer: "CHERRY", clue: "Small, red, on cakes" },
        { answer: "LEMON", clue: "Sour, yellow" },
        { answer: "PLUM", clue: "Purple, small fruit" },
        { answer: "PEAR", clue: "Green, bell-shaped" },
        { answer: "KIWI", clue: "Brown outside, green inside" },
        { answer: "GRAPE", clue: "Wine is made from this" },
        { answer: "LYCHEE", clue: "Red shell, white inside" }
      ],
      job: [
        { answer: "DOCTOR", clue: "Heals the sick" },
        { answer: "LAWYER", clue: "Defends in court" },
        { answer: "TEACHER", clue: "Educates students" },
        { answer: "CHEF", clue: "Cooks food" },
        { answer: "ACTOR", clue: "Performs in movies" },
        { answer: "NURSE", clue: "Assists doctors" },
        { answer: "PILOT", clue: "Flies planes" },
        { answer: "ARTIST", clue: "Creates art" },
        { answer: "WRITER", clue: "Writes books" },
        { answer: "DANCER", clue: "Performs on stage" }
      ],
      plant: [
        { answer: "ROSE", clue: "Red flower, thorns" },
        { answer: "LOTUS", clue: "Sacred water flower" },
        { answer: "BAMBOO", clue: "Panda's favorite" },
        { answer: "CACTUS", clue: "Desert plant, spines" },
        { answer: "IVY", clue: "Climbing plant" },
        { answer: "FERN", clue: "Lush, leafy plant" },
        { answer: "MOSS", clue: "Soft, green, on rocks" },
        { answer: "PALM", clue: "Tropical tree" },
        { answer: "LILY", clue: "White, trumpet-shaped" },
        { answer: "MAPLE", clue: "Syrup comes from this" }
      ],
      music: [
        { answer: "PIANO", clue: "88 keys, classical" },
        { answer: "VIOLIN", clue: "String instrument, bow" },
        { answer: "DRUM", clue: "Percussion, beats" },
        { answer: "FLUTE", clue: "Wind instrument" },
        { answer: "GUITAR", clue: "Strings, rock music" },
        { answer: "TRUMPET", clue: "Brass, loud sound" },
        { answer: "HARP", clue: "Many strings, angelic" },
        { answer: "CELLO", clue: "Large, deep strings" },
        { answer: "SAX", clue: "Jazz instrument" },
        { answer: "BANJO", clue: "Country music" }
      ]
    };

    // 音效
    const audioCorrect = new Audio("https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae5b2.mp3");
    const audioWrong = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_115b9b7b7e.mp3");
    const audioWin = new Audio("https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae5b2.mp3");

    // 花瓣飘落动画
    function createPetal() {
      const petal = document.createElement("div");
      petal.className = "petal";
      petal.style.left = Math.random() * 100 + "vw";
      petal.style.animationDuration = 2 + Math.random() * 2 + "s";
      document.body.appendChild(petal);
      setTimeout(() => petal.remove(), 4000);
    }
    function bloomEffect() {
      for (let i = 0; i < 12; i++) setTimeout(createPetal, i * 120);
    }

    // Toast
    function showToast(msg) {
      let toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.style.opacity = 1;
      setTimeout(() => (toast.style.opacity = 0), 1200);
    }

    // Fisher-Yates 洗牌
    function shuffle(arr) {
      let a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // 游戏状态
    let currentCategory = "";
    let currentLevel = 0;
    let currentStreak = 0;
    let wordList = [];
    let answer = "";
    let clue = "";
    let userInput = [];
    let availableLetters = [];
    let isAnimating = false;

    // DOM
    const homePage = document.getElementById("homePage");
    const gamePage = document.getElementById("gamePage");
    const levelText = document.getElementById("levelText");
    const streakText = document.getElementById("streakText");
    const clueText = document.getElementById("clueText");
    const grid = document.getElementById("grid");
    const letterBox = document.getElementById("letterBox");
    const nextBtn = document.getElementById("nextBtn");
    const backBtn = document.getElementById("backBtn");
    const homeBtn = document.getElementById("homeBtn");

    // 首页开始
    window.startGame = function (cat) {
      currentCategory = cat;
      wordList = shuffle(allWordData[cat]);
      currentLevel = 0;
      currentStreak = 0;
      homePage.style.display = "none";
      gamePage.style.display = "flex";
      loadLevel();
    };

    // 加载关卡
    function loadLevel() {
      isAnimating = false;
      answer = wordList[currentLevel].answer;
      clue = wordList[currentLevel].clue;
      userInput = Array(answer.length).fill("");
      availableLetters = shuffle(answer.split(""));
      levelText.textContent = `Level ${currentLevel + 1} of 10`;
      streakText.textContent = `Streak: ${currentStreak}`;
      clueText.textContent = clue;
      grid.innerHTML = "";
      letterBox.innerHTML = "";
      // 拼写区
      for (let i = 0; i < answer.length; i++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = "";
        cell.addEventListener("click", () => {
          if (userInput[i] && !isAnimating) {
            // 还原字母
            for (let j = 0; j < availableLetters.length; j++) {
              if (availableLetters[j] === "") {
                availableLetters[j] = userInput[i];
                renderLetters();
                break;
              }
            }
            userInput[i] = "";
            renderGrid();
          }
        });
        grid.appendChild(cell);
      }
      // 字母盘
      renderLetters();
      renderGrid();
      nextBtn.style.display = "none";
    }

    // 渲染字母盘
    function renderLetters() {
      letterBox.innerHTML = "";
      availableLetters.forEach((ch, idx) => {
        const btn = document.createElement("div");
        btn.className = "letter";
        btn.textContent = ch;
        btn.style.visibility = ch ? "visible" : "hidden";
        btn.addEventListener("click", () => {
          if (!ch || isAnimating) return;
          // 填入拼写区
          for (let i = 0; i < userInput.length; i++) {
            if (!userInput[i]) {
              userInput[i] = ch;
              availableLetters[idx] = "";
              renderLetters();
              renderGrid();
              checkFilled();
              break;
            }
          }
        });
        letterBox.appendChild(btn);
      });
    }

    // 渲染拼写区
    function renderGrid() {
      Array.from(grid.children).forEach((cell, i) => {
        cell.textContent = userInput[i] || "";
      });
    }

    // 检查是否填满
    function checkFilled() {
      if (userInput.every(Boolean)) {
        if (userInput.join("") === answer) {
          isAnimating = true;
          audioCorrect.currentTime = 0;
          audioCorrect.play();
          bloomEffect();
          showToast("BLOOM!");
          Array.from(grid.children).forEach(cell => {
            cell.classList.add("correct");
            setTimeout(() => cell.classList.remove("correct"), 800);
          });
          currentStreak++;
          streakText.textContent = `Streak: ${currentStreak}`;
          nextBtn.style.display = "block";
        } else {
          isAnimating = true;
          audioWrong.currentTime = 0;
          audioWrong.play();
          showToast("Try again!");
          grid.classList.add("shake");
          setTimeout(() => {
            grid.classList.remove("shake");
            isAnimating = false;
          }, 600);
          currentStreak = 0;
          streakText.textContent = `Streak: ${currentStreak}`;
        }
      }
    }

    // 下一题
    nextBtn.addEventListener("click", () => {
      if (currentLevel < 9) {
        currentLevel++;
        loadLevel();
      } else {
        audioWin.currentTime = 0;
        audioWin.play();
        showToast("You finished all levels!");
        setTimeout(() => {
          gamePage.style.display = "none";
          homePage.style.display = "flex";
        }, 1200);
      }
    });

    // 返回
    backBtn.addEventListener("click", () => {
      if (currentLevel > 0) {
        currentLevel--;
        loadLevel();
      }
    });

    // 回首页
    homeBtn.addEventListener("click", () => {
      gamePage.style.display = "none";
      homePage.style.display = "flex";
    });
  </script>
</body>
</html>
