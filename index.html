<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Word Puzzle Game</title>
  <style>
    :root {
      --accent: #4caf50;
      --wrong: #ffcdd2;
      --correct: #c8e6c9;
      --hint: #fff9c4;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #f9f9f9, #e0f2f1);
      margin: 0;
      padding: 12px;
      text-align: center;
      max-width: 480px;
      margin-left: auto;
      margin-right: auto;
      color: #333;
    }
    h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }
    .username {
      font-size: 16px;
      color: #666;
      margin-bottom: 20px;
    }
    .category-selection,
    .game-section {
      display: none;
    }
    .category-selection.active,
    .game-section.active {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .category {
      background: white;
      padding: 16px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      cursor: pointer;
      width: 130px;
      transition: transform 0.2s, background 0.3s;
    }
    .category:hover {
      transform: translateY(-5px);
      background: #e8f5e9;
    }
    .emoji {
      font-size: 32px;
      margin-bottom: 8px;
    }
    .status,
    .clue {
      font-size: 18px;
      margin: 12px 0;
    }
    .grid {
      display: flex;
      justify-content: center;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 4px;
      margin-bottom: 12px;
      position: relative;
    }
    .cell {
      width: 60px;
      height: 60px;
      background-color: white;
      border: 2px solid #ccc;
      border-radius: 8px;
      font-size: 24px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s;
    }
    .letters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 8px;
      margin-bottom: 16px;
      padding: 0 8px;
      max-width: 100%;
      box-sizing: border-box;
    }
    .letter {
      width: 50px;
      height: 50px;
      background-color: var(--hint);
      border: 2px solid #fbc02d;
      border-radius: 10px;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: grab;
      box-shadow: var(--shadow);
      animation: fadeIn 0.4s ease;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px;
      padding: 0 10px;
      box-sizing: border-box;
      margin-bottom: 20px;
    }
    button {
      background-color: var(--accent);
      color: white;
      border: none;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: background 0.3s;
    }
    button:hover {
      background-color: #388e3c;
    }
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes flashWin {
      0%, 100% { background-color: var(--correct); }
      50% { background-color: #b2ff59; }
    }
    @keyframes flyStar {
      0% { opacity: 0; transform: scale(0) translateY(0); }
      50% { opacity: 1; transform: scale(1.2) translateY(-40px); }
      100% { opacity: 0; transform: scale(0.5) translateY(-80px); }
    }
    .cell.correct { animation: pop 0.3s ease; }
    .grid.win { animation: flashWin 0.6s ease-in-out 3; }
    .star {
      position: absolute;
      font-size: 24px;
      color: gold;
      animation: flyStar 1s ease forwards;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }
  </style>
</head>
<body>
  <h1>Word Puzzle Game</h1>
  <div class="username" id="username"></div>

<!-- Telegram Login Widget -->
<script async src="https://telegram.org/js/telegram-widget.js?22"
  data-telegram-login="feyaaaa_bot"
  data-size="large"
  data-onauth="onTelegramAuth"
  data-request-access="write">
</script>

<script>
  function onTelegramAuth(user) {
    const displayName = user.username
      ? `@${user.username}`
      : `${user.first_name || ''} ${user.last_name || ''}`.trim();
    document.getElementById("username").textContent = `Welcome, ${displayName}`;
    console.log('Telegram user:', user);
  }
</script>
  <div id="categoryPage" class="category-selection active">
    <div class="category" onclick="startGame('food')">
      <div class="emoji">üçé</div>
      <div>Food & Drinks</div>
    </div>
    <div class="category" onclick="startGame('animals')">
      <div class="emoji">üêØ</div>
      <div>Animals</div>
    </div>
    <div class="category" onclick="startGame('nature')">
      <div class="emoji">üåç</div>
      <div>Nature</div>
    </div>
    <div class="category" onclick="startGame('jobs')">
      <div class="emoji">üíº</div>
      <div>Jobs</div>
    </div>
    <div class="category" onclick="startGame('mind')">
      <div class="emoji">üß†</div>
      <div>Mind</div>
    </div>
  </div>
  <div id="gamePage" class="game-section" style="flex-direction: column; align-items: center;">
    <div class="status" id="status" style="margin-bottom: 4px;"></div>
    <div class="clue" id="clue" style="margin-bottom: 12px;"></div>
    <div class="grid" id="grid" style="margin-top: 0;"></div>
    <div class="letters" id="letters" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 8px; margin-bottom: 16px; padding: 0 8px; max-width: 100%; box-sizing: border-box; min-height: 100px;"></div>
    <div class="controls" style="position: sticky; bottom: 0; background: #f9f9f9; padding: 10px 0 12px; z-index: 5;">
      <button onclick="loadWord()">üîÑ Retry</button>
      <button onclick="nextLevel()">‚û°Ô∏è Next</button>
      <button onclick="goHome()">üè† Home</button>
    </div>
  </div>
  <script>
    let words = [], current = 0, streak = 0;

    const allWordData = {
      food: [
        { answer: "APPLE", clue: "A fruit and a tech company" },
        { answer: "BREAD", clue: "Staple made from flour" },
        { answer: "JUICE", clue: "Fruit drink" }
      ],
      animals: [
        { answer: "ZEBRA", clue: "Striped animal" },
        { answer: "TIGER", clue: "Big cat with stripes" }
      ],
      nature: [
        { answer: "OCEAN", clue: "Vast body of saltwater" },
        { answer: "FOREST", clue: "Many trees together" }
      ],
      jobs: [
        { answer: "DOCTOR", clue: "Treats sick people" },
        { answer: "LAWYER", clue: "Works in court" }
      ],
      mind: [
        { answer: "BRAIN", clue: "Used for thinking" },
        { answer: "HEART", clue: "Pumps blood" }
      ]
    };

    function startGame(category) {
      words = allWordData[category] || [];
      current = 0;
      streak = 0;
      if (!words.length) {
        alert("No words available in this category.");
        return;
      }
      document.getElementById("categoryPage").classList.remove("active");
      document.getElementById("gamePage").classList.add("active");
      loadWord();
    }

    function loadWord() {
  if (!words[current]) return;
  const { answer, clue } = words[current];
  const clueBox = document.getElementById("clue");
  const grid = document.getElementById("grid");
  const letters = document.getElementById("letters");

  clueBox.textContent = `Clue: ${clue}`;
  grid.innerHTML = '';
  letters.innerHTML = '';

  const shuffled = answer.split('').sort(() => Math.random() - 0.5);

  const userAnswer = [];
  answer.split('').forEach((_, i) => {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.setAttribute("data-index", i);
    grid.appendChild(cell);
  });

  shuffled.forEach((c, index) => {
    const tile = document.createElement("div");
    tile.className = "letter animate-in";
    tile.textContent = c;
    tile.addEventListener("click", () => {
      const emptyCell = [...document.querySelectorAll(".cell")].find(cell => cell.textContent === '');
      if (!emptyCell) return;
      emptyCell.textContent = c;
      tile.remove();
      userAnswer.push({ char: c, cell: emptyCell });
      checkAnswer();
    });
    letters.appendChild(tile);
  });

  const backspaceBtn = document.createElement("button");
  backspaceBtn.textContent = "‚Üê Backspace";
  backspaceBtn.onclick = () => {
    const last = userAnswer.pop();
    if (last) {
      last.cell.textContent = '';
      last.cell.classList.remove("correct");
      last.cell.style.backgroundColor = '';
      const restoredTile = document.createElement("div");
      restoredTile.className = "letter animate-in";
      restoredTile.textContent = last.char;
      restoredTile.addEventListener("click", () => {
        const emptyCell = [...document.querySelectorAll(".cell")].find(cell => cell.textContent === '');
        if (!emptyCell) return;
        emptyCell.textContent = last.char;
        userAnswer.push({ char: last.char, cell: emptyCell });
        restoredTile.remove();
        checkAnswer();
      });
      letters.appendChild(restoredTile);
    }
  };
  const tools = document.createElement("div");
  tools.style.display = "flex";
  tools.style.justifyContent = "center";
  tools.style.gap = "10px";
  tools.style.marginTop = "10px";
  tools.appendChild(backspaceBtn);
  tools.appendChild(shuffleBtn);
  letters.appendChild(tools);
  };
  letters.appendChild(tools);

  [...document.querySelectorAll(".cell")].forEach(cell => {
    cell.addEventListener("click", () => {
      const index = userAnswer.findIndex(entry => entry.cell === cell);
      if (index !== -1) {
        const removed = userAnswer.splice(index, 1)[0];
        cell.textContent = '';
        cell.classList.remove("correct");
        cell.style.backgroundColor = '';
        const restoredTile = document.createElement("div");
        restoredTile.className = "letter animate-in";
        restoredTile.textContent = removed.char;
        restoredTile.addEventListener("click", () => {
          const emptyCell = [...document.querySelectorAll(".cell")].find(cell => cell.textContent === '');
          if (!emptyCell) return;
          emptyCell.textContent = removed.char;
          userAnswer.push({ char: removed.char, cell: emptyCell });
          restoredTile.remove();
          checkAnswer();
        });
        letters.appendChild(restoredTile);
      }
    });
  });

  document.getElementById("status").textContent = `üî• Streak: ${streak}`;
    }

    function checkAnswer() {
      if (!words[current]) return;
      const { answer } = words[current];
      const grid = document.getElementById("grid");
      const cells = [...document.querySelectorAll(".cell")];
      const result = cells.map(c => c.textContent).join('');

      if (result.length !== answer.length) return;

      let correct = true;
      cells.forEach((cell, i) => {
        const match = cell.textContent === answer[i];
        cell.style.backgroundColor = match ? 'var(--correct)' : 'var(--wrong)';
        cell.style.transition = 'background-color 0.3s';
        if (match) cell.classList.add("correct");
        else correct = false;
      });

      if (correct) {
        [...cells].forEach(cell => cell.classList.add("correct"));
        streak++;
        grid.classList.add("win");
        const star = document.createElement("div");
        star.className = "star";
        star.textContent = "‚≠ê";
        grid.appendChild(star);
        setTimeout(() => {
          grid.classList.remove("win");
          star.remove();
          star.remove();
          nextLevel();
        }, 1000);
      }
    }

    function nextLevel() {
      current++;
      if (current >= words.length) {
        alert("You've finished all words in this category!");
        goHome();
        return;
      }
      loadWord();
    }

    function goHome() {
      document.getElementById("gamePage").classList.remove("active");
      document.getElementById("categoryPage").classList.add("active");
    }
  </script>
</body>
</html>
